<div class="flex flex-col justify-between h-full w-full p-4">
  <div class="flex-1 overflow-auto relative w-full">
    <div class="flex flex-col gap-y-4 absolute w-full">
      @for (
        chatMessage of displayedChatMessages$ | async;
        track i;
        let i = $index
      ) {
        <div
          class="w-full flex"
          [ngClass]="{
            'justify-start': !chatMessage.sentByPlayer,
            'justify-end': chatMessage.sentByPlayer
          }"
        >
          <div class="flex flex-col gap-y-1">
            <div class="opacity-80 text-sm">
              {{ chatMessage.name }}
            </div>

            @for (message of chatMessage.messages; track j; let j = $index) {
              <div
                class="flex"
                [ngClass]="{
                  'justify-start': !chatMessage.sentByPlayer,
                  'justify-end': chatMessage.sentByPlayer
                }"
              >
                <div class="border border-gray-300 rounded-sm p-2">
                  {{ message }}
                </div>
              </div>
            }

            <div class="opacity-80 text-sm">
              {{ chatMessage.date | date: 'shortTime' }}
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <input
    type="text"
    placeholder="Type your message..."
    class="border border-gray-300 rounded-sm p-2 w-full focus:outline-none focus:border-blue-500 dark:text-black"
    [(ngModel)]="message"
    (keydown.enter)="sendMessage()"
  />
</div>
