<nav
  class="sidebar bg-gray-50 dark:bg-gray-700 h-full flex flex-col transition w-20 shadow-lg"
>
  @if ((playerGameView$ | async)?.GameCode; as gameCode) {
    <div class="flex flex-col justify-around text-center my-2 px-1">
      <div class="semibold text-center text-sm h-sm-hidden">Game<br />Code</div>
      <div class="tracking-widest font-bold text-center text-md mt-1">
        {{ gameCode }}
      </div>
    </div>
  }

  <div
    class="h-px rounded-lg bg-gray-400 dark:bg-gray-600 mx-2 transition"
  ></div>

  <div
    class="px-1 pt-2 flex flex-col pb-4"
    [ngClass]="{
      'lg:hidden': !(isShowingCardStack$ | async)
    }"
  >
    <icon-button
      [matTooltip]="(isShowingCardStack$ | async) ? 'Hide Stack' : 'Show Stack'"
      matTooltipPosition="right"
      iconString="playing_cards"
      label="Stack"
      (clicked)="toggleCardStack()"
      iconClass="material-symbols-outlined"
      buttonClass="rounded-sm hover:bg-white dark:hover:bg-gray-700"
    ></icon-button>
  </div>

  @if (isShowingCardStack$ | async) {
    <card-stack
      class="flex-1 pb-4"
      [cardStack]="cardStack"
      [position]="selectedPosition"
      [cardSize]="(cardSize$ | async) ?? 48"
      [redJokerLaneIndex]="redJokerLaneIndex"
      [blackJokerLaneIndex]="blackJokerLaneIndex"
    ></card-stack>
  } @else {
    <div class="px-1 flex flex-col gap-y-4 py-2">
      <icon-button
        data-testid="pass-move-button"
        [disabled]="!!(waitingForServer$ | async)"
        matTooltip="Pass move"
        matTooltipPosition="right"
        iconString="waving_hand"
        (clicked)="attemptToOpenPassMoveModal()"
        label="Pass"
        iconClass="material-symbols-outlined"
        buttonClass="rounded-sm hover:bg-white dark:hover:bg-gray-700"
      ></icon-button>
      <icon-button
        [disabled]="!!(waitingForServer$ | async)"
        matTooltip="Offer draw"
        matTooltipPosition="right"
        iconString="handshake"
        iconClass="material-symbols-outlined"
        (clicked)="attemptToOpenOfferDrawModel()"
        label="Draw"
        buttonClass="rounded-sm hover:bg-white dark:hover:bg-gray-700"
      ></icon-button>
      <icon-button
        [disabled]="!!(waitingForServer$ | async)"
        matTooltip="Resign"
        matTooltipPosition="right"
        iconString="flag"
        iconClass="material-symbols-outlined"
        (clicked)="openResignModal()"
        label="Resign"
        buttonClass="rounded-sm hover:bg-white dark:hover:bg-gray-700"
      ></icon-button>
      <icon-button
        class="block dark:hidden"
        matTooltip="Dark Mode"
        matTooltipPosition="right"
        iconClass="material-symbols-outlined"
        iconString="dark_mode"
        (clicked)="toggleDarkMode()"
        label="Dark"
        buttonClass="rounded-sm hover:bg-white dark:hover:bg-gray-700"
      ></icon-button>
      <icon-button
        class="hidden dark:block"
        matTooltip="Light Mode"
        matTooltipPosition="right"
        iconClass="material-symbols-outlined"
        iconString="light_mode"
        (clicked)="toggleDarkMode()"
        label="Light"
        buttonClass="rounded-sm hover:bg-white dark:hover:bg-gray-700"
      ></icon-button>
    </div>

    @if (numCardsInOpponentDeck !== null && numCardsInPlayerDeck !== null) {
      <div class="h-px rounded-lg bg-gray-400 dark:bg-gray-600 mx-2"></div>
    }
    @if (numCardsInOpponentDeck !== null && numCardsInPlayerDeck !== null) {
      <div class="game-stats">
        <div
          data-testid="opponent-time"
          class="border border-1 border-gray-400 rounded-sm text-gray-800 bg-gray-100 font-bold py-1 text-lg mx-2 text-center transition mb-2"
          [ngClass]="{
            'is-not-counting-down': isPlayersTurn
          }"
        >
          <span>
            {{ opponentsRemainingSecondsString }}
          </span>
        </div>
        <div>
          <div data-testid="opponent-deck-count" class="deck-count">
            {{ numCardsInOpponentDeck }}
          </div>
          <div class="flex justify-around">
            <game-face-down-card></game-face-down-card>
          </div>
          <div class="hidden md:flex h-sm-hidden flex justify-around">
            <game-face-down-card></game-face-down-card>
          </div>
          <div data-testid="player-deck-count" class="deck-count">
            {{ numCardsInPlayerDeck }}
          </div>
        </div>
        <div
          data-testid="player-time"
          class="border border-1 border-gray-400 rounded-sm text-gray-800 bg-gray-100 font-bold py-1 text-lg mx-2 text-center transition mt-2"
          [ngClass]="{
            'low-time-container': playerHasLowTime,
            'is-not-counting-down': !isPlayersTurn
          }"
        >
          <span>{{ playersRemainingSecondsString }}</span>
        </div>
      </div>
    }
  }
</nav>
